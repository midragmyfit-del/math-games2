<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×œ××“ ×œ×¦×™×™×¨ ××¤×§×˜×™× ××“×”×™××™×</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .title {
            text-align: center;
            color: white;
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        .main-container {
            display: flex;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
            flex-wrap: wrap;
            justify-content: center;
        }
        .canvas-container {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            flex: 1;
            min-width: 300px;
        }
        .canvas-title {
            text-align: center;
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 15px;
        }
        canvas {
            border: 3px solid #667eea;
            border-radius: 15px;
            cursor: none;
            display: block;
            margin: 0 auto;
            background: white;
        }
        #cursor {
            position: fixed;
            border: 3px solid #fff;
            box-shadow: 0 0 0 2px #000, inset 0 0 0 2px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 10000;
            display: none;
            transform: translate(-50%, -50%);
        }
        #cursor::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 1px;
            height: 10px;
            background: #000;
            box-shadow: 1px 0 0 #fff, -1px 0 0 #fff;
        }
        #cursor::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 10px;
            height: 1px;
            background: #000;
            box-shadow: 0 1px 0 #fff, 0 -1px 0 #fff;
        }
        .controls {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            width: 300px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .control-section { text-align: center; }
        .section-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }
        .instruction-box {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            font-size: 1.3em;
            font-weight: bold;
            text-align: center;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        .step-counter {
            font-size: 1.1em;
            color: #666;
            margin-top: 10px;
        }
        .button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 25px;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.5);
        }
        .button:disabled {
            background: #ccc;
            cursor: not-allowed;
            box-shadow: none;
        }
        .nav-buttons { display: flex; gap: 10px; }
        .color-palette {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            justify-items: center;
        }
        .color-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: 3px solid #ddd;
            cursor: pointer;
            transition: all 0.3s;
        }
        .color-btn:hover { transform: scale(1.2); }
        .color-btn.selected {
            border-color: #FFD700;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
            transform: scale(1.2);
        }
        .tool-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 10px;
        }
        .tool-btn {
            padding: 10px 20px;
            border: 2px solid #ddd;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            font-size: 1.5em;
            transition: all 0.3s;
        }
        .tool-btn:hover { transform: scale(1.1); }
        .tool-btn.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
        }
        .drawing-menu {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            max-width: 600px;
            width: 90%;
        }
        .drawing-menu.hidden { display: none; }
        .menu-title {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            text-align: center;
            margin-bottom: 30px;
        }
        .drawing-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .drawing-option {
            background: linear-gradient(135deg, #f5f7fa, #c3cfe2);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid transparent;
        }
        .drawing-option:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            border-color: #667eea;
        }
        .drawing-icon { font-size: 3em; margin-bottom: 10px; }
        .drawing-name {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
        }
        .difficulty-stars {
            color: #FFD700;
            font-size: 0.9em;
            margin-top: 5px;
        }
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }
        .overlay.hidden { display: none; }
        .size-slider { width: 100%; margin: 10px 0; }
    </style>
</head>
<body>
    <div id="cursor"></div>
    <div class="overlay hidden" id="overlay"></div>
    
    <div class="drawing-menu" id="drawingMenu">
        <div class="menu-title">ğŸ’¥ ×‘×—×¨ ××¤×§×˜ ××“×”×™×</div>
        <div class="drawing-options">
            <div class="drawing-option" onclick="selectDrawing('lightning')">
                <div class="drawing-icon">âš¡</div>
                <div class="drawing-name">×‘×¨×§ ×‘×©××™×™×</div>
                <div class="difficulty-stars">â˜…â˜…â˜†â˜†â˜†</div>
            </div>
            <div class="drawing-option" onclick="selectDrawing('explosion')">
                <div class="drawing-icon">ğŸ’¥</div>
                <div class="drawing-name">×¢× ×Ÿ ×¤×™×¦×•×¥</div>
                <div class="difficulty-stars">â˜…â˜…â˜…â˜†â˜†</div>
            </div>
            <div class="drawing-option" onclick="selectDrawing('fire')">
                <div class="drawing-icon">ğŸ”¥</div>
                <div class="drawing-name">×œ×”×‘×•×ª ××©</div>
                <div class="difficulty-stars">â˜…â˜…â˜…â˜†â˜†</div>
            </div>
            <div class="drawing-option" onclick="selectDrawing('water')">
                <div class="drawing-icon">ğŸ’§</div>
                <div class="drawing-name">×”×ª×–×ª ××™×</div>
                <div class="difficulty-stars">â˜…â˜…â˜…â˜†â˜†</div>
            </div>
        </div>
    </div>
    
    <div class="title">ğŸ’¥ ×œ××“ ×œ×¦×™×™×¨ ××¤×§×˜×™× ××“×”×™××™× - ×©×œ×‘ ××—×¨ ×©×œ×‘! âš¡</div>
    
    <div class="main-container">
        <div class="canvas-container">
            <div class="canvas-title">×”×“×•×’××” - ×¢×§×•×‘ ××—×¨×™ ×”×©×œ×‘×™× ğŸ‘€</div>
            <canvas id="exampleCanvas" width="400" height="400"></canvas>
        </div>
        
        <div class="controls">
            <div class="control-section">
                <div class="instruction-box" id="instruction">×‘×—×¨ ××¤×§×˜ ××“×”×™× ××”×ª×¤×¨×™×˜ ×›×“×™ ×œ×”×ª×—×™×œ!</div>
                <div class="step-counter" id="stepCounter"></div>
            </div>
            
            <div class="control-section">
                <div class="section-title">×›×œ×™× ğŸ› ï¸</div>
                <div class="tool-buttons">
                    <button class="tool-btn active" id="drawBtn" onclick="selectDrawTool()">âœï¸ ×¢×˜</button>
                    <button class="tool-btn" id="eraserBtn" onclick="selectEraser()">ğŸ§¹ ××—×§</button>
                </div>
            </div>
            
            <div class="control-section">
                <div class="section-title">×¦×‘×¢×™× ğŸ¨</div>
                <div class="color-palette" id="colorPalette"></div>
            </div>
            
            <div class="control-section">
                <div class="section-title">×¢×•×‘×™ ××›×—×•×œ</div>
                <input type="range" class="size-slider" id="brushSize" min="2" max="15" value="5">
            </div>
            
            <div class="control-section">
                <div class="nav-buttons">
                    <button class="button" id="prevBtn" onclick="prevStep()" disabled>â¬…ï¸ ×§×•×“×</button>
                    <button class="button" id="nextBtn" onclick="nextStep()" disabled>×”×‘× â¡ï¸</button>
                </div>
            </div>
            
            <button class="button" onclick="clearMyCanvas()">ğŸ—‘ï¸ × ×§×” ××ª ×”×¦×™×•×¨ ×©×œ×™</button>
            <button class="button" onclick="saveDrawing()">ğŸ’¾ ×©××•×¨ ××ª ×”×¦×™×•×¨ ×©×œ×™</button>
            <button class="button" onclick="showMenu()">ğŸ¨ ×‘×—×¨ ××¤×§×˜ ××—×¨</button>
        </div>
        
        <div class="canvas-container">
            <div class="canvas-title">×”×¦×™×•×¨ ×©×œ×š - ×¦×™×™×¨ ×›××Ÿ! âœï¸</div>
            <canvas id="myCanvas" width="400" height="400"></canvas>
        </div>
    </div>

    <script>
        const ex = document.getElementById('exampleCanvas');
        const my = document.getElementById('myCanvas');
        const exCtx = ex.getContext('2d');
        const myCtx = my.getContext('2d');
        const cursor = document.getElementById('cursor');
        
        let curr = null;
        let step = 0;
        let draw = false;
        let col = '#000000';
        let size = 5;
        let erase = false;
        
        function updCursor() {
            const s = erase ? size * 4 : size * 2;
            cursor.style.width = s + 'px';
            cursor.style.height = s + 'px';
            if (erase) {
                cursor.style.borderColor = '#fff';
                cursor.style.boxShadow = '0 0 0 2px #ff0000, inset 0 0 0 2px #ff0000';
            } else {
                cursor.style.borderColor = '#fff';
                cursor.style.boxShadow = '0 0 0 2px #000, inset 0 0 0 2px ' + col;
            }
        }
        
        my.addEventListener('mouseenter', () => {
            cursor.style.display = 'block';
            updCursor();
        });
        
        my.addEventListener('mouseleave', () => {
            cursor.style.display = 'none';
        });
        
        my.addEventListener('mousemove', (e) => {
            cursor.style.left = e.pageX + 'px';
            cursor.style.top = e.pageY + 'px';
        });
        
        const cols = [
            '#000000','#FFFFFF','#FF0000','#00FF00','#0000FF',
            '#FFFF00','#FFA500','#800080','#FF00FF','#00FFFF',
            '#FFC0CB','#00BFFF','#87CEEB','#FFD700','#FF69B4',
            '#FF1493','#8B4513','#FFE4B5','#FFDAB9','#8B0000',
            '#DC143C','#006400','#000080','#90EE90','#FF6347'
        ];

        const data = {
            lightning: {
                name: '×‘×¨×§ ×‘×©××™×™×',
                steps: [
                    {instruction:'×©×œ×‘ 1: ×¨×§×¢ ×©××™×™× ×›×”×™×',draw:c=>{c.fillStyle='#000080';c.fillRect(0,0,400,400)}},
                    {instruction:'×©×œ×‘ 2: ×¢× × ×™× ×›×”×™×',draw:c=>{c.fillStyle='#2F4F4F';c.beginPath();c.arc(85,65,42,0,Math.PI*2);c.arc(140,55,52,0,Math.PI*2);c.arc(195,60,47,0,Math.PI*2);c.arc(245,65,42,0,Math.PI*2);c.arc(285,75,37,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 3: ×‘×¨×§ ×¦×”×•×‘ ×¨××©×™ - ×—×œ×§ 1',draw:c=>{c.strokeStyle='#FFFF00';c.lineWidth=12;c.lineCap='round';c.beginPath();c.moveTo(200,85);c.lineTo(180,145);c.stroke()}},
                    {instruction:'×©×œ×‘ 4: ×‘×¨×§ ×¦×”×•×‘ ×¨××©×™ - ×—×œ×§ 2',draw:c=>{c.strokeStyle='#FFFF00';c.lineWidth=12;c.lineCap='round';c.beginPath();c.moveTo(180,145);c.lineTo(205,145);c.lineTo(175,210);c.stroke()}},
                    {instruction:'×©×œ×‘ 5: ×‘×¨×§ ×¦×”×•×‘ ×¨××©×™ - ×—×œ×§ 3',draw:c=>{c.strokeStyle='#FFFF00';c.lineWidth=12;c.lineCap='round';c.beginPath();c.moveTo(175,210);c.lineTo(200,210);c.lineTo(168,285);c.stroke()}},
                    {instruction:'×©×œ×‘ 6: ×‘×¨×§ ×¦×”×•×‘ ×¨××©×™ - ×—×œ×§ 4',draw:c=>{c.strokeStyle='#FFFF00';c.lineWidth=12;c.lineCap='round';c.beginPath();c.moveTo(168,285);c.lineTo(190,285);c.lineTo(160,350);c.stroke()}},
                    {instruction:'×©×œ×‘ 7: ×‘×¨×§ ×œ×‘×Ÿ ×¤× ×™××™ - ×—×œ×§ 1',draw:c=>{c.strokeStyle='#FFF';c.lineWidth=6;c.lineCap='round';c.beginPath();c.moveTo(200,85);c.lineTo(180,145);c.lineTo(205,145);c.stroke()}},
                    {instruction:'×©×œ×‘ 8: ×‘×¨×§ ×œ×‘×Ÿ ×¤× ×™××™ - ×—×œ×§ 2',draw:c=>{c.strokeStyle='#FFF';c.lineWidth=6;c.lineCap='round';c.beginPath();c.moveTo(205,145);c.lineTo(175,210);c.lineTo(200,210);c.stroke()}},
                    {instruction:'×©×œ×‘ 9: ×‘×¨×§ ×œ×‘×Ÿ ×¤× ×™××™ - ×—×œ×§ 3',draw:c=>{c.strokeStyle='#FFF';c.lineWidth=6;c.lineCap='round';c.beginPath();c.moveTo(200,210);c.lineTo(168,285);c.lineTo(190,285);c.lineTo(160,350);c.stroke()}},
                    {instruction:'×©×œ×‘ 10: ×‘×¨×§ ×¦×“×“×™ ×©×××œ',draw:c=>{c.strokeStyle='#FFFF00';c.lineWidth=8;c.lineCap='round';c.beginPath();c.moveTo(110,95);c.lineTo(92,155);c.lineTo(105,155);c.lineTo(80,225);c.stroke()}},
                    {instruction:'×©×œ×‘ 11: ×‘×¨×§ ×¦×“×“×™ ×™××™×Ÿ',draw:c=>{c.strokeStyle='#FFFF00';c.lineWidth=8;c.lineCap='round';c.beginPath();c.moveTo(280,90);c.lineTo(298,150);c.lineTo(285,150);c.lineTo(310,220);c.stroke()}},
                    {instruction:'×©×œ×‘ 12: ×–×•×”×¨ ×¡×‘×™×‘ ×”×‘×¨×§',draw:c=>{c.fillStyle='rgba(255,255,255,0.2)';c.beginPath();c.arc(188,175,65,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 13: ×›×•×›×‘×™× 1-3',draw:c=>{c.fillStyle='#FFF';[[35,130],[330,140],[45,300]].forEach(s=>{c.beginPath();c.arc(s[0],s[1],2,0,Math.PI*2);c.fill()})}},
                    {instruction:'×©×œ×‘ 14: ×›×•×›×‘×™× 4-6',draw:c=>{c.fillStyle='#FFF';[[320,310],[75,215],[300,230]].forEach(s=>{c.beginPath();c.arc(s[0],s[1],2,0,Math.PI*2);c.fill()})}}
                ]
            },
            explosion: {
                name: '×¢× ×Ÿ ×¤×™×¦×•×¥',
                steps: [
                    {instruction:'×©×œ×‘ 1: ×¨×§×¢ ×©×—×•×¨',draw:c=>{c.fillStyle='#000';c.fillRect(0,0,400,400)}},
                    {instruction:'×©×œ×‘ 2: ×¢× ×Ÿ ×—×™×¦×•× ×™ ××“×•× ×›×”×”',draw:c=>{c.fillStyle='#8B0000';const p=[[200,75],[245,95],[280,115],[305,155],[315,200],[305,240],[270,275],[225,295],[180,300],[135,285],[100,250],[75,210],[80,165],[95,125],[135,95],[170,80]];c.beginPath();c.moveTo(p[0][0],p[0][1]);for(let i=1;i<p.length;i++)c.lineTo(p[i][0],p[i][1]);c.closePath();c.fill()}},
                    {instruction:'×©×œ×‘ 3: ×©×›×‘×” ××“×•××”',draw:c=>{c.fillStyle='#FF0000';const p=[[200,105],[235,120],[265,145],[275,185],[265,220],[235,245],[200,260],[165,245],[135,220],[125,185],[135,145],[165,120]];c.beginPath();c.moveTo(p[0][0],p[0][1]);for(let i=1;i<p.length;i++)c.lineTo(p[i][0],p[i][1]);c.closePath();c.fill()}},
                    {instruction:'×©×œ×‘ 4: ×©×›×‘×” ×›×ª×•××”',draw:c=>{c.fillStyle='#FFA500';c.beginPath();c.arc(200,185,55,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 5: ××¨×›×– ×¦×”×•×‘',draw:c=>{c.fillStyle='#FFFF00';c.beginPath();c.arc(200,185,35,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 6: ××¨×›×– ×œ×‘×Ÿ',draw:c=>{c.fillStyle='#FFF';c.beginPath();c.arc(200,185,18,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 7: × ×™×¦×•×¥ ×¢×œ×™×•×Ÿ',draw:c=>{c.fillStyle='#FFD700';c.beginPath();c.arc(200,30,7,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 8: × ×™×¦×•×¥ ×™××™×Ÿ ×¢×œ×™×•×Ÿ',draw:c=>{c.fillStyle='#FFD700';c.beginPath();c.arc(300,75,7,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 9: × ×™×¦×•×¥ ×™××™×Ÿ',draw:c=>{c.fillStyle='#FFD700';c.beginPath();c.arc(340,185,7,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 10: × ×™×¦×•×¥ ×™××™×Ÿ ×ª×—×ª×•×Ÿ',draw:c=>{c.fillStyle='#FFD700';c.beginPath();c.arc(300,295,7,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 11: × ×™×¦×•×¥ ×ª×—×ª×•×Ÿ',draw:c=>{c.fillStyle='#FFD700';c.beginPath();c.arc(200,340,7,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 12: × ×™×¦×•×¥ ×©×××œ ×ª×—×ª×•×Ÿ',draw:c=>{c.fillStyle='#FFD700';c.beginPath();c.arc(100,295,7,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 13: × ×™×¦×•×¥ ×©×××œ',draw:c=>{c.fillStyle='#FFD700';c.beginPath();c.arc(60,185,7,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 14: × ×™×¦×•×¥ ×©×××œ ×¢×œ×™×•×Ÿ',draw:c=>{c.fillStyle='#FFD700';c.beginPath();c.arc(100,75,7,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 15: ×§×•×•×™ ×× ×¨×’×™×”',draw:c=>{c.strokeStyle='#FFD700';c.lineWidth=3;for(let i=0;i<8;i++){const a=(i*Math.PI)/4;c.beginPath();c.moveTo(200+Math.cos(a)*65,185+Math.sin(a)*65);c.lineTo(200+Math.cos(a)*95,185+Math.sin(a)*95);c.stroke()}}}
                ]
            },
            fire: {
                name: '×œ×”×‘×•×ª ××©',
                steps: [
                    {instruction:'×©×œ×‘ 1: ×¨×§×¢ ×©×—×•×¨',draw:c=>{c.fillStyle='#000';c.fillRect(0,0,400,400)}},
                    {instruction:'×©×œ×‘ 2: ×§×¨×§×¢ ×—×•××”',draw:c=>{c.fillStyle='#8B4513';c.fillRect(0,340,400,60)}},
                    {instruction:'×©×œ×‘ 3: ×“×©× ×™×¨×•×§',draw:c=>{c.fillStyle='#90EE90';c.fillRect(0,330,400,15)}},
                    {instruction:'×©×œ×‘ 4: ×œ×”×‘×” ××¨×›×–×™×ª - ×‘×¡×™×¡ ××“×•× ×›×”×”',draw:c=>{c.fillStyle='#8B0000';c.beginPath();c.moveTo(135,340);c.quadraticCurveTo(155,270,165,220);c.quadraticCurveTo(175,170,185,120);c.quadraticCurveTo(195,170,205,220);c.quadraticCurveTo(215,270,235,340);c.closePath();c.fill()}},
                    {instruction:'×©×œ×‘ 5: ×œ×”×‘×” ××¨×›×–×™×ª - ×©×›×‘×” ××“×•××”',draw:c=>{c.fillStyle='#FF0000';c.beginPath();c.moveTo(145,340);c.quadraticCurveTo(160,280,170,230);c.quadraticCurveTo(178,185,185,140);c.quadraticCurveTo(192,185,200,230);c.quadraticCurveTo(210,280,225,340);c.closePath();c.fill()}},
                    {instruction:'×©×œ×‘ 6: ×œ×”×‘×” ××¨×›×–×™×ª - ×©×›×‘×” ×›×ª×•××”',draw:c=>{c.fillStyle='#FFA500';c.beginPath();c.moveTo(155,340);c.quadraticCurveTo(165,295,175,250);c.quadraticCurveTo(180,210,185,170);c.quadraticCurveTo(190,210,195,250);c.quadraticCurveTo(205,295,215,340);c.closePath();c.fill()}},
                    {instruction:'×©×œ×‘ 7: ×œ×”×‘×” ××¨×›×–×™×ª - ×©×›×‘×” ×¦×”×•×‘×”',draw:c=>{c.fillStyle='#FFFF00';c.beginPath();c.moveTo(165,340);c.quadraticCurveTo(173,305,180,270);c.quadraticCurveTo(183,235,185,200);c.quadraticCurveTo(187,235,190,270);c.quadraticCurveTo(197,305,205,340);c.closePath();c.fill()}},
                    {instruction:'×©×œ×‘ 8: ×œ×”×‘×” ×©×××œ - ××“×•×',draw:c=>{c.fillStyle='#FF0000';c.beginPath();c.moveTo(70,340);c.quadraticCurveTo(80,300,85,260);c.quadraticCurveTo(90,300,100,340);c.closePath();c.fill()}},
                    {instruction:'×©×œ×‘ 9: ×œ×”×‘×” ×©×××œ - ×›×ª×•×',draw:c=>{c.fillStyle='#FFA500';c.beginPath();c.moveTo(75,340);c.quadraticCurveTo(82,310,85,280);c.quadraticCurveTo(88,310,95,340);c.closePath();c.fill()}},
                    {instruction:'×©×œ×‘ 10: ×œ×”×‘×” ×™××™×Ÿ - ××“×•×',draw:c=>{c.fillStyle='#FF0000';c.beginPath();c.moveTo(300,340);c.quadraticCurveTo(310,300,315,260);c.quadraticCurveTo(320,300,330,340);c.closePath();c.fill()}},
                    {instruction:'×©×œ×‘ 11: ×œ×”×‘×” ×™××™×Ÿ - ×›×ª×•×',draw:c=>{c.fillStyle='#FFA500';c.beginPath();c.moveTo(305,340);c.quadraticCurveTo(312,310,315,280);c.quadraticCurveTo(318,310,325,340);c.closePath();c.fill()}},
                    {instruction:'×©×œ×‘ 12: × ×™×¦×•×¦×•×ª 1-4',draw:c=>{c.fillStyle='#FFD700';[[155,95],[175,75],[205,85],[225,100]].forEach(p=>{c.beginPath();c.arc(p[0],p[1],5,0,Math.PI*2);c.fill()})}},
                    {instruction:'×©×œ×‘ 13: × ×™×¦×•×¦×•×ª 5-8',draw:c=>{c.fillStyle='#FFD700';[[145,135],[230,125],[160,165],[215,160]].forEach(p=>{c.beginPath();c.arc(p[0],p[1],5,0,Math.PI*2);c.fill()})}},
                    {instruction:'×©×œ×‘ 14: ×¢×©×Ÿ 1',draw:c=>{c.fillStyle='rgba(128,128,128,0.4)';c.beginPath();c.arc(185,60,32,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 15: ×¢×©×Ÿ 2',draw:c=>{c.fillStyle='rgba(128,128,128,0.4)';c.beginPath();c.arc(170,40,27,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 16: ×¢×©×Ÿ 3',draw:c=>{c.fillStyle='rgba(128,128,128,0.4)';c.beginPath();c.arc(200,45,24,0,Math.PI*2);c.fill()}}
                ]
            },
            water: {
                name: '×”×ª×–×ª ××™×',
                steps: [
                    {instruction:'×©×œ×‘ 1: ×¨×§×¢ ×ª×›×œ×ª ×‘×”×™×¨',draw:c=>{c.fillStyle='#87CEEB';c.fillRect(0,0,400,400)}},
                    {instruction:'×©×œ×‘ 2: ×§×¨×§×¢ ×—×•××”',draw:c=>{c.fillStyle='#8B4513';c.fillRect(0,310,400,90)}},
                    {instruction:'×©×œ×‘ 3: ×“×©× ×™×¨×•×§',draw:c=>{c.fillStyle='#90EE90';c.fillRect(0,295,400,20)}},
                    {instruction:'×©×œ×‘ 4: ×’×œ ××™× - ×›×—×•×œ ×›×”×”',draw:c=>{c.fillStyle='#0000FF';c.beginPath();c.ellipse(200,260,70,55,0,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 5: ×’×œ ××™× - ×ª×›×œ×ª',draw:c=>{c.fillStyle='#00BFFF';c.beginPath();c.ellipse(200,255,65,50,0,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 6: ×’×œ ××™× - ×›×—×•×œ ×‘×”×™×¨',draw:c=>{c.fillStyle='#87CEEB';c.beginPath();c.ellipse(200,250,55,42,0,0,Math.PI*2);c.fill()}},
                    {instruction:'×©×œ×‘ 7: ×˜×™×¤×” ×’×“×•×œ×” 1',draw:c=>{c.fillStyle='#0000FF';c.beginPath();c.arc(200,130,14,0,Math.PI*2);c.fill();c.beginPath();c.moveTo(200,116);c.quadraticCurveTo(190,105,200,90);c.quadraticCurveTo(210,105,200,116);c.fill()}},
                    {instruction:'×©×œ×‘ 8: ×˜×™×¤×” ×’×“×•×œ×” 2',draw:c=>{c.fillStyle='#0000FF';c.beginPath();c.arc(155,165,14,0,Math.PI*2);c.fill();c.beginPath();c.moveTo(155,151);c.quadraticCurveTo(145,140,155,125);c.quadraticCurveTo(165,140,155,151);c.fill()}},
                    {instruction:'×©×œ×‘ 9: ×˜×™×¤×” ×’×“×•×œ×” 3',draw:c=>{c.fillStyle='#0000FF';c.beginPath();c.arc(245,160,14,0,Math.PI*2);c.fill();c.beginPath();c.moveTo(245,146);c.quadraticCurveTo(235,135,245,120);c.quadraticCurveTo(255,135,245,146);c.fill()}},
                    {instruction:'×©×œ×‘ 10: ×˜×™×¤×” ×’×“×•×œ×” 4',draw:c=>{c.fillStyle='#0000FF';c.beginPath();c.arc(170,200,14,0,Math.PI*2);c.fill();c.beginPath();c.moveTo(170,186);c.quadraticCurveTo(160,175,170,160);c.quadraticCurveTo(180,175,170,186);c.fill()}},
                    {instruction:'×©×œ×‘ 11: ×˜×™×¤×” ×’×“×•×œ×” 5',draw:c=>{c.fillStyle='#0000FF';c.beginPath();c.arc(230,195,14,0,Math.PI*2);c.fill();c.beginPath();c.moveTo(230,181);c.quadraticCurveTo(220,170,230,155);c.quadraticCurveTo(240,170,230,181);c.fill()}},
                    {instruction:'×©×œ×‘ 12: ×˜×™×¤×•×ª ×‘×™× ×•× ×™×•×ª 1-3',draw:c=>{c.fillStyle='#00BFFF';[[140,145],[215,140],[260,175]].forEach(p=>{c.beginPath();c.arc(p[0],p[1],9,0,Math.PI*2);c.fill();c.beginPath();c.moveTo(p[0],p[1]-9);c.quadraticCurveTo(p[0]-6,p[1]-15,p[0],p[1]-22);c.quadraticCurveTo(p[0]+6,p[1]-15,p[0],p[1]-9);c.fill()})}},
                    {instruction:'×©×œ×‘ 13: ×˜×™×¤×•×ª ×‘×™× ×•× ×™×•×ª 4-6',draw:c=>{c.fillStyle='#00BFFF';[[135,190],[180,185],[250,210]].forEach(p=>{c.beginPath();c.arc(p[0],p[1],9,0,Math.PI*2);c.fill();c.beginPath();c.moveTo(p[0],p[1]-9);c.quadraticCurveTo(p[0]-6,p[1]-15,p[0],p[1]-22);c.quadraticCurveTo(p[0]+6,p[1]-15,p[0],p[1]-9);c.fill()})}},
                    {instruction:'×©×œ×‘ 14: ×˜×™×¤×•×ª ×‘×™× ×•× ×™×•×ª 7-10',draw:c=>{c.fillStyle='#00BFFF';[[165,220],[210,215],[120,225],[260,225]].forEach(p=>{c.beginPath();c.arc(p[0],p[1],9,0,Math.PI*2);c.fill();c.beginPath();c.moveTo(p[0],p[1]-9);c.quadraticCurveTo(p[0]-6,p[1]-15,p[0],p[1]-22);c.quadraticCurveTo(p[0]+6,p[1]-15,p[0],p[1]-9);c.fill()})}},
                    {instruction:'×©×œ×‘ 15: ×˜×™×¤×•×ª ×§×˜× ×•×ª 1-5',draw:c=>{c.fillStyle='#87CEEB';for(let i=0;i<5;i++){const x=120+i*40;const y=100+Math.random()*30;c.beginPath();c.arc(x,y,4,0,Math.PI*2);c.fill()}}},
                    {instruction:'×©×œ×‘ 16: ×˜×™×¤×•×ª ×§×˜× ×•×ª 6-10',draw:c=>{c.fillStyle='#87CEEB';for(let i=0;i<5;i++){const x=130+i*35;const y=140+Math.random()*25;c.beginPath();c.arc(x,y,4,0,Math.PI*2);c.fill()}}},
                    {instruction:'×©×œ×‘ 17: ×˜×™×¤×•×ª ×§×˜× ×•×ª 11-15',draw:c=>{c.fillStyle='#87CEEB';for(let i=0;i<5;i++){const x=140+i*30;const y=175+Math.random()*20;c.beginPath();c.arc(x,y,4,0,Math.PI*2);c.fill()}}},
                    {instruction:'×©×œ×‘ 18: ×‘×¨×§ ××™× 1',draw:c=>{c.strokeStyle='#FFF';c.lineWidth=4;c.lineCap='round';const a=-Math.PI/3;c.beginPath();c.moveTo(200+Math.cos(a)*35,260+Math.sin(a)*35);c.lineTo(200+Math.cos(a)*85,260+Math.sin(a)*85);c.stroke()}},
                    {instruction:'×©×œ×‘ 19: ×‘×¨×§ ××™× 2-3',draw:c=>{c.strokeStyle='#FFF';c.lineWidth=4;c.lineCap='round';[-Math.PI/6,0].forEach(a=>{c.beginPath();c.moveTo(200+Math.cos(a)*35,260+Math.sin(a)*35);c.lineTo(200+Math.cos(a)*85,260+Math.sin(a)*85);c.stroke()})}},
                    {instruction:'×©×œ×‘ 20: ×‘×¨×§ ××™× 4-5',draw:c=>{c.strokeStyle='#FFF';c.lineWidth=4;c.lineCap='round';[Math.PI/6,Math.PI/3].forEach(a=>{c.beginPath();c.moveTo(200+Math.cos(a)*35,260+Math.sin(a)*35);c.lineTo(200+Math.cos(a)*85,260+Math.sin(a)*85);c.stroke()})}},
                    {instruction:'×©×œ×‘ 21: × ×¦× ×•×¥ ×œ×‘×Ÿ',draw:c=>{c.fillStyle='rgba(255,255,255,0.7)';c.beginPath();c.arc(180,240,18,0,Math.PI*2);c.fill()}}
                ]
            }
        };
        
        function init() {
            const p = document.getElementById('colorPalette');
            cols.forEach(color => {
                const b = document.createElement('div');
                b.className = 'color-btn' + (color === col ? ' selected' : '');
                b.style.background = color;
                b.setAttribute('data-color', color);
                b.onclick = function() {
                    col = this.getAttribute('data-color');
                    erase = false;
                    document.querySelectorAll('.color-btn').forEach(btn => btn.classList.remove('selected'));
                    this.classList.add('selected');
                    document.getElementById('drawBtn').classList.add('active');
                    document.getElementById('eraserBtn').classList.remove('active');
                    updCursor();
                };
                p.appendChild(b);
            });
        }
        
        function selectDrawTool() {
            erase = false;
            document.getElementById('drawBtn').classList.add('active');
            document.getElementById('eraserBtn').classList.remove('active');
            updCursor();
        }
        
        function selectEraser() {
            erase = true;
            document.getElementById('eraserBtn').classList.add('active');
            document.getElementById('drawBtn').classList.remove('active');
            document.querySelectorAll('.color-btn').forEach(btn => btn.classList.remove('selected'));
            updCursor();
        }
        
        document.getElementById('brushSize').addEventListener('input', (e) => {
            size = parseInt(e.target.value);
            updCursor();
        });
        
        function showMenu() {
            document.getElementById('drawingMenu').classList.remove('hidden');
            document.getElementById('overlay').classList.remove('hidden');
        }
        
        function hideMenu() {
            document.getElementById('drawingMenu').classList.add('hidden');
            document.getElementById('overlay').classList.add('hidden');
        }
        
        function selectDrawing(n) {
            curr = data[n];
            step = 0;
            exCtx.clearRect(0, 0, 400, 400);
            myCtx.clearRect(0, 0, 400, 400);
            upd();
            hideMenu();
            document.getElementById('nextBtn').disabled = false;
        }
        
        function clearMyCanvas() {
            myCtx.clearRect(0, 0, 400, 400);
        }
        
        function saveDrawing() {
            if (!curr) { 
                alert('×‘×—×¨ ××¤×§×˜ ×ª×—×™×œ×”!'); 
                return; 
            }
            const l = document.createElement('a');
            l.download = '××¤×§×˜_' + curr.name + '.png';
            l.href = my.toDataURL();
            l.click();
        }
        
        function upd() {
            if (!curr) return;
            exCtx.clearRect(0, 0, 400, 400);
            for (let i = 0; i <= step; i++) curr.steps[i].draw(exCtx);
            document.getElementById('instruction').textContent = curr.steps[step].instruction;
            document.getElementById('stepCounter').textContent = '×©×œ×‘ ' + (step + 1) + ' ××ª×•×š ' + curr.steps.length;
            document.getElementById('prevBtn').disabled = step === 0;
            document.getElementById('nextBtn').disabled = step === curr.steps.length - 1;
        }
        
        function nextStep() {
            if (curr && step < curr.steps.length - 1) { step++; upd(); }
        }
        
        function prevStep() {
            if (step > 0) { step--; upd(); }
        }
        
        my.addEventListener('mousedown', (e) => {
            draw = true;
            const r = my.getBoundingClientRect();
            myCtx.beginPath();
            myCtx.moveTo(e.clientX - r.left, e.clientY - r.top);
        });
        
        my.addEventListener('mousemove', (e) => {
            if (!draw) return;
            const r = my.getBoundingClientRect();
            myCtx.lineCap = 'round';
            myCtx.lineJoin = 'round';
            if (erase) {
                myCtx.globalCompositeOperation = 'destination-out';
                myCtx.lineWidth = size * 2;
            } else {
                myCtx.globalCompositeOperation = 'source-over';
                myCtx.strokeStyle = col;
                myCtx.lineWidth = size;
            }
            myCtx.lineTo(e.clientX - r.left, e.clientY - r.top);
            myCtx.stroke();
        });
        
        my.addEventListener('mouseup', () => { draw = false; });
        my.addEventListener('mouseout', () => { draw = false; });
        
        my.addEventListener('touchstart', (e) => {
            e.preventDefault();
            draw = true;
            const t = e.touches[0];
            const r = my.getBoundingClientRect();
            myCtx.beginPath();
            myCtx.moveTo(t.clientX - r.left, t.clientY - r.top);
        });
        
        my.addEventListener('touchmove', (e) => {
            e.preventDefault();
            if (!draw) return;
            const t = e.touches[0];
            const r = my.getBoundingClientRect();
            myCtx.lineCap = 'round';
            myCtx.lineJoin = 'round';
            if (erase) {
                myCtx.globalCompositeOperation = 'destination-out';
                myCtx.lineWidth = size * 2;
            } else {
                myCtx.globalCompositeOperation = 'source-over';
                myCtx.strokeStyle = col;
                myCtx.lineWidth = size;
            }
            myCtx.lineTo(t.clientX - r.left, t.clientY - r.top);
            myCtx.stroke();
        });
        
        my.addEventListener('touchend', () => { draw = false; });
        
        init();
    </script>
</body>
</html>